<!-- Sidebar Agent -->
<div class="agent-sidebar">
  <div class="sidebar-header">
    <h2 class="sidebar-logo">ParisCitizen</h2>
    <p class="sidebar-subtitle">Agent Municipal</p>
  </div>
  
  <nav class="sidebar-nav">
    <ul class="nav-list">
      <li class="nav-item">
        <a routerLink="/agent/dashboard" routerLinkActive="active" class="nav-link">
          <span class="nav-icon">ðŸ“Š</span>
          <span class="nav-text">Dashboard</span>
        </a>
      </li>
      <li class="nav-item">
        <a routerLink="/agent/projets" routerLinkActive="active" class="nav-link">
          <span class="nav-icon">ðŸŽ¯</span>
          <span class="nav-text">Projets</span>
        </a>
      </li>
      <li class="nav-item">
        <a routerLink="/agent/reclamations" routerLinkActive="active" class="nav-link">
          <span class="nav-icon">ðŸ“‹</span>
          <span class="nav-text">RÃ©clamations</span>
        </a>
      </li>
      <li class="nav-item">
        <a routerLink="/agent/profil" routerLinkActive="active" class="nav-link">
          <span class="nav-icon">ðŸ‘¤</span>
          <span class="nav-text">Profil</span>
        </a>
      </li>
    </ul>
  </nav>
  
  <div class="sidebar-footer">
    <button class="logout-btn" (click)="logout()">
      <span class="nav-icon">ðŸšª</span>
      <span class="nav-text">DÃ©connexion</span>
    </button>
  </div>
</div>

<!-- Contenu principal -->
<div class="agent-main-content">
  <div class="dashboard-container">
    <div class="dashboard-header">
      <div>
        <h1 class="dashboard-title">Dashboard Agent Municipal</h1>
        <p style="color: var(--dark-color); margin: 0;">Gestion des signalements et projets de votre arrondissement</p>
      </div>
      <div class="user-info" *ngIf="currentUser">
        <div class="user-avatar">{{ (currentUser.prenom || currentUser.nom || currentUser.email || 'A').charAt(0).toUpperCase() }}</div>
        <div>
          <div style="font-weight: 600; color: var(--primary-color);">{{ currentUser.prenom }} {{ currentUser.nom }}</div>
          <div style="font-size: 0.9rem; color: var(--dark-color);">Agent municipal</div>
        </div>
      </div>
    </div>

    <!-- Statistiques principales -->
    <div class="stats-grid" *ngIf="statistiques">
      <div class="stat-card">
        <div class="stat-icon">ðŸ˜Š</div>
        <div class="stat-content">
          <div class="stat-number">{{ statistiques.tauxSatisfaction }}%</div>
          <div class="stat-label">Taux de satisfaction</div>
          <div class="stat-progress">
            <div class="progress-bar">
              <div class="progress-fill" [style.width.%]="statistiques.tauxSatisfaction"></div>
            </div>
          </div>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-icon">ðŸ“‹</div>
        <div class="stat-content">
          <div class="stat-number">{{ statistiques.reclamationsRecues }}</div>
          <div class="stat-label">RÃ©clamations reÃ§ues</div>
          <div class="stat-detail">{{ statistiques.reclamationsTraitees }} traitÃ©es</div>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-icon">ðŸŽ¯</div>
        <div class="stat-content">
          <div class="stat-number">{{ statistiques.projetsActifs }}</div>
          <div class="stat-label">Projets actifs</div>
          <div class="stat-detail">{{ statistiques.projetsTermines }} terminÃ©s</div>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-icon">ðŸ“ˆ</div>
        <div class="stat-content">
          <div class="stat-number">{{ getTauxTraitement() }}%</div>
          <div class="stat-label">Taux de traitement</div>
          <div class="stat-detail">RÃ©clamations rÃ©solues</div>
        </div>
      </div>
    </div>

    <!-- Graphiques et analyses -->
    <div class="analytics-grid">
      <!-- Sujets les plus discutÃ©s -->
      <div class="analytics-card">
        <div class="card-header">
          <h3>ðŸ”¥ Sujets les plus discutÃ©s</h3>
        </div>
        <div class="topics-list" *ngIf="statistiques">
          <div class="topic-item" *ngFor="let sujet of statistiques.sujetsPopulaires">
            <div class="topic-info">
              <span class="topic-name">{{ sujet.sujet }}</span>
              <span class="topic-count">{{ sujet.nombre }} rÃ©clamations</span>
            </div>
            <div class="topic-bar">
              <div class="topic-fill" [style.width.%]="sujet.pourcentage"></div>
            </div>
            <span class="topic-percentage">{{ sujet.pourcentage }}%</span>
          </div>
        </div>
      </div>

      <!-- Tendance mensuelle -->
      <div class="analytics-card">
        <div class="card-header">
          <h3>ðŸ“Š Tendance mensuelle</h3>
        </div>
        <div class="chart-container" *ngIf="statistiques">
          <div class="chart-bars">
            <div class="chart-bar" *ngFor="let mois of statistiques.tendanceMensuelle">
              <div class="bar-reclamations" [style.height.%]="getBarHeight(mois.reclamations)"></div>
              <div class="bar-projets" [style.height.%]="getBarHeight(mois.projets * 3)"></div>
              <span class="bar-label">{{ mois.mois }}</span>
            </div>
          </div>
          <div class="chart-legend">
            <div class="legend-item">
              <div class="legend-color reclamations"></div>
              <span>RÃ©clamations</span>
            </div>
            <div class="legend-item">
              <div class="legend-color projets"></div>
              <span>Projets</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Actions rapides -->
    <div class="quick-actions">
      <h3>Actions rapides</h3>
      <div class="actions-grid">
        <button class="action-btn" routerLink="/agent/reclamations">
          <span class="action-icon">ðŸ“‹</span>
          <span class="action-text">Nouvelles rÃ©clamations</span>
          <span class="action-count" *ngIf="getNouvellesReclamations() > 0">{{ getNouvellesReclamations() }}</span>
        </button>
        
        <button class="action-btn" routerLink="/agent/projets">
          <span class="action-icon">ðŸŽ¯</span>
          <span class="action-text">GÃ©rer les projets</span>
        </button>
        
        <button class="action-btn" (click)="showCreateProject = !showCreateProject">
          <span class="action-icon">âž•</span>
          <span class="action-text">Nouveau projet</span>
        </button>
        
        <button class="action-btn" routerLink="/agent/profil">
          <span class="action-icon">ðŸ‘¤</span>
          <span class="action-text">Mon profil</span>
        </button>
      </div>
    </div>

    <!-- Modal crÃ©ation projet (simulÃ©) -->
    <div class="modal-overlay" *ngIf="showCreateProject" (click)="showCreateProject = false">
      <div class="modal-content" (click)="$event.stopPropagation()">
        <div class="modal-header">
          <h3>CrÃ©er un nouveau projet</h3>
          <button class="modal-close" (click)="showCreateProject = false">Ã—</button>
        </div>
        <div class="modal-body">
          <p>ðŸš§ FonctionnalitÃ© en cours de dÃ©veloppement</p>
          <p>Cette fonctionnalitÃ© sera disponible dans la prochaine version.</p>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" (click)="showCreateProject = false">Fermer</button>
        </div>
      </div>
    </div>
  </div>
</div>



